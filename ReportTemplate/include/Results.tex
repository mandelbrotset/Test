\chapter{Results}
For RQ2, our study has shown a way of analyzing conflict resolutions in large-scale codebases, and this can be achieved by parsing output from Conflicts Analyzer. Likewise, for RQ3, our study has indeed showed that it is possible to create a meaningful categorization of merge-conflict resolutions which could be used in future studies to, for instance, create an automatic merge tool. This chapter shows the results of the manual- and automatic analysis.
\section{Manual Analysis}
For conflicts in the conflict pattern SameSignatureCM, we found that if one of the two versions had the same code as the other version but with some additional code, that version was often chosen as resolution. This can be seen in Table \ref{table:rcsitma} where the resolution was a superset in 69\% of the cases. Table \ref{table:rcsitma} lists how many resolutions, in the 26 cases that were analyzed, were \textit{Superset}, \textit{Intersection} and/or \textit{Recent}. As a resolution can be both recent and a superset or an intersection at the same time, the percentage add up to more than 100\%.
\begin{table}
\caption{Results of the manual analysis for the properties in Table \ref{table:pproperties}}\label{table:rcsitma}
\begin{tabular}{ p{6cm} p{6cm} }
\hline
\multicolumn{1}{c}{\textbf{Property}} & \multicolumn{1}{c}{\textbf{Number of cases (total 26 cases)}}\\
Superset & 18 (~69\%)\\
Recent & 15 (~58\%)\\
Intersection & 4 (~15\%)\\
\end{tabular}
\end{table}
\FloatBarrier
For some of the cases that were chosen as resolution, one or more if-statements had been introduced in the version that was chosen which the other version did not have. We also saw an example of a case where the chosen version had more error handling than the other version.

An example can be seen from the repository Android-async-http, where two versions that resulted in a conflict when being merged looked like this:\\
\textbf{Left version:}
\lstset{language=Java,numbers=left,xleftmargin=2em,frame=single,framexleftmargin=1.5em}
\begin{lstlisting}[frame=single,breaklines=true,tabsize=2]
protected void sendSuccessMessage(int statusCode, Header[] headers, String responseBody) {
	try {
		Object jsonResponse = parseResponse(responseBody);
		sendMessage(obtainMessage(SUCCESS_JSON_MESSAGE, new Object[]{statusCode, headers, jsonResponse}));
	} catch(JSONException e) {
		sendFailureMessage(e, responseBody);
	}
}
\end{lstlisting}
\textbf{Right version:}
\lstset{language=Java,numbers=left,xleftmargin=2em,frame=single,framexleftmargin=1.5em}
\begin{lstlisting}[frame=single,breaklines=true,tabsize=2]
protected void sendSuccessMessage(int statusCode, Header[] headers, String responseBody) {
	if (statusCode != HttpStatus.SC_NO_CONTENT){
		try {
			Object jsonResponse = parseResponse(responseBody);
			sendMessage(obtainMessage(SUCCESS_JSON_MESSAGE, new Object[]{statusCode, headers, jsonResponse}));
		} catch(JSONException e) {
			sendFailureMessage(e, responseBody);
		}
	} else {
		sendMessage(obtainMessage(SUCCESS_JSON_MESSAGE, new Object[]{statusCode, new JSONObject()}));
	}
}
\end{lstlisting}
Here, all the words in the left version are also in the right version, hence the right is a superset of the left version. In this example, the right version was chosen as the resolution. As can also be seen, in the right version there is a check by an if-statement that is not present in the left version.
\FloatBarrier
\section{Automatic Analysis}
\FloatBarrier
The automatic analysis that was conducted on the 20 top starred Java projects on GitHub yielded, after our filtering, 1964 conflicts. For each property (see Table \ref{table:propdef}), the resolutions for the 1964 conflicts was categorized according to Table \ref{table:pproperties2} and the results are presented in this section.
\FloatBarrier
In 1509 cases (77\% of the studied cases), the left version was chosen that is, the version in the commit that was checked out at the time of merging. Figure \ref{fig:groups} shows how many cases there are in each group.

\begin{figure}
\begin{tikzpicture}
 \begin{axis}[
     symbolic x coords={LEFT, RIGHT, NONE},
     xtick=data,
     xlabel=\textbf{Group},
     ylabel=\textbf{Chosen resolutions}
   ]
     \addplot[ybar,fill=blue] coordinates {
         (LEFT,   1509)
         (RIGHT,  77)
         (NONE,   378)
     };
 \end{axis}
\end{tikzpicture}
\caption{Number of chosen resolutions for each group}\label{fig:groups}
\end{figure}
\FloatBarrier
For cases where one of the versions was chosen completely, we can show that this chosen version ofter is the most recent version, as can be seen in Figure \ref{fig:recent}.

\begin{figure}
\begin{tikzpicture}
\begin{axis}[ybar stacked,symbolic x coords={LEFT,RIGHT},xtick=data,enlarge x limits={abs=1.5cm},xlabel=\textbf{Group},ylabel=\textbf{Chosen resolutions},legend pos=outer north east]
    \addplot[black!40,fill=blue] coordinates
{(LEFT,1161)(RIGHT,40)};
    \addplot[black!40,fill=red]  coordinates
{(LEFT,348)(RIGHT,37)};
\legend{Recent, Non recent}
\end{axis}
\end{tikzpicture}
\caption{Number of most recent versions chosen}\label{fig:recent}
\end{figure}
\FloatBarrier
For some cases, the left and the right version differ in how many instances of specific keywords they contain. Figure \ref{fig:keywords} shows how often the version with most instances and the version with least instances of each keyword was chosen. \textit{Neither} means that the resolution is in the group \textit{None}, see Figure \ref{fig:groups}.


Chart \ref{fig:setleft} and Chart \ref{fig:setright} show how often the left version and the right version is a superset or an intersection, and how often those versions are chosen as resolution.


%Total:
%TOT: flest,		färst, 		ingen, Non applicable
%	 recent, 	not recent		 , Non applicable
%	 sup/int	den andra	none , Non applicable


\begin{figure}
\resizebox {\columnwidth} {!} {
\begin{tikzpicture}
\begin{axis}[ybar stacked,symbolic x coords={Recent,Superset,Intersection,if-statements,print-instances,log-instances,try-instances},xtick=data,enlarge x limits={abs=1.5cm},xlabel=\textbf{Category},ylabel=\textbf{Conflicts},legend pos=outer north east,
   xticklabel style={
           inner sep=0pt,
           anchor=north east,
           rotate=45 }
   ]
]
    \addplot[black!40,fill=blue] coordinates{(Recent,1201)(Superset,333)(Intersection,186)(if-statements,39)(print-instances,6)(log-instances,4)(try-instances,17)};
    \addplot[black!40,fill=red] coordinates{(Recent,385)(Superset,186)(Intersection,333)(if-statements,26)(print-instances,2)(log-instances,5)(try-instances,11)};
    \addplot[black!40,fill=green] coordinates{(Recent,378)(Superset,184)(Intersection,184)(if-statements,67)(print-instances,13)(log-instances,7)(try-instances,7)};
    \addplot[black!40,fill=white] coordinates{(Recent,0)(Superset,1261)(Intersection,1261)(if-statements,1832)(print-instances,1943)(log-instances,1948)(try-instances,1929)};
\legend{Chosen, Other chosen, None chosen, Not applicable}
\end{axis}
\end{tikzpicture}
}
\caption{Classification of conflicts for each category.}\label{fig:setright}
\end{figure}

\begin{figure}
\resizebox {\columnwidth} {!} {
\begin{tikzpicture}
\begin{axis}[ybar stacked,symbolic x coords={Recent,Superset,Intersection,if-statements,print-instances,log-instances,try-instances},xtick=data,enlarge x limits={abs=1.5cm},xlabel=\textbf{Category},ylabel=\textbf{Conflicts},legend pos=outer north east,
xticklabel style={
           inner sep=0pt,
           anchor=north east,
           rotate=45 }]
    \addplot[black!40,fill=blue] coordinates{(Recent,1161)(Superset,305)(Intersection,160)(if-statements,32)(print-instances,6)(log-instances,2)(try-instances,13)};
    \addplot[black!40,fill=red] coordinates{(Recent,37)(Superset,26)(Intersection,28)(if-statements,13)(print-instances,0)(log-instances,0)(try-instances,4)};
    \addplot[black!40,fill=green] coordinates{(Recent,252)(Superset,93)(Intersection,91)(if-statements,32)(print-instances,10)(log-instances,5)(try-instances,4)};
    \addplot[black!40,fill=white] coordinates{(Recent,514)(Superset,1540)(Intersection,1685)(if-statements,1887)(print-instances,1948)(log-instances,1957)(try-instances,1943)};
\legend{Chosen, Other chosen, None chosen, Not applicable}
\end{axis}
\end{tikzpicture}
}
\caption{Classification of conflicts for each category for the LEFT versions.}\label{fig:setright}
\end{figure}

\begin{figure}
\resizebox {\columnwidth} {!} {
\begin{tikzpicture}
\begin{axis}[ybar stacked,symbolic x coords={Recent,Superset,Intersection,if-statements,print-instances,log-instances,try-instances},xtick=data,enlarge x limits={abs=1.5cm},xlabel=\textbf{Category},ylabel=\textbf{Conflicts},legend pos=outer north east,
xticklabel style={
           inner sep=0pt,
           anchor=north east,
           rotate=45 }]
    \addplot[black!40,fill=blue] coordinates{(Recent,40)(Superset,28)(Intersection,26)(if-statements,7)(print-instances,0)(log-instances,2)(try-instances,4)};
    \addplot[black!40,fill=red] coordinates{(Recent,348)(Superset,160)(Intersection,305)(if-statements,13)(print-instances,2)(log-instances,5)(try-instances,7)};
    \addplot[black!40,fill=green] coordinates{(Recent,126)(Superset,91)(Intersection,93)(if-statements,35)(print-instances,3)(log-instances,2)(try-instances,3)};
    \addplot[black!40,fill=white] coordinates{(Recent,1450)(Superset,1685)(Intersection,1540)(if-statements,1909)(print-instances,1959)(log-instances,1955)(try-instances,1950)};
\legend{Chosen, Other chosen, None chosen, Not applicable}
\end{axis}
\end{tikzpicture}
}
\caption{Classification of conflicts for each category for the RIGHT versions.}\label{fig:setright}
\end{figure}

\section{Discussion}
The most important result in this study is that in cases of conflicting code in methods or constructors in 3 out of 4 cases, developers tend to choose the left version when merging. The reasons for this is unclear, but there are two main scenarios; when pulling a remote branch and when merging a local branch into another one.

The left version is the commit that the developer who performs the merge has checked out when merging. If the conflicting merge is a result of pulling a remote branch, the left version is likely his own code, and the right version is someone else’s code. Table \ref{fig:recent} shows that the chosen version also often is the most recent version. This in combination with that the left version most often is chosen indicates that developers tend to choose their own code as resolution. This study has not gone into why developers resolve conflicts this way, but it might be interesting for future studies to investigate this further. If the conflicting merge is a result of merging a local branch into another one, the left version is the branch which the other branch was merged into.

Another interesting note about the results is that versions containing more of the keywords print and log are only chosen in about 1 out of 4 times. This might be because printouts and logging statements are removed at the time of the merge, when hopefully the newly implemented code is working as intended and tested, thus printouts and logs is no longer needed.

\subsection{Threats to Validity}
Our results are based on a sample of 20 projects, and a total of 1964 conflicts were analyzed. The results might differ if other projects were to be analyzed. The 20 top starred projects were all java projects, we can not say if our results hold for other languages. Also, these were all open-source projects. Inside companies, development can be done in other ways, thus our results might not be the same if analyzing in non open-source projects. The projects analyzed varies in size. 

The Conflicts Analyzer tool are not developed by us and when running it for the first times, it contained some bugs which we had to solve. Although we managed to solve them, if there still are any bugs present in the tool, then it would be a threat to validity to our own results.

